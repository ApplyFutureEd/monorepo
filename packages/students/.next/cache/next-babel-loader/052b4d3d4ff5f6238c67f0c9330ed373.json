{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/paul/projects/applyfuture/students/packages/students/src/pages_/programs.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport Container from '@components/core/container/Container';\nimport DashboardLayout from '@components/layouts/dashboard-layout/DashboardLayout';\nimport Filters from '@components/programs/filters/Filters';\nimport Row from '@components/programs/row/Row';\nimport SkeletonRow from '@components/programs/row/SkeletonRow';\nimport Search from '@components/programs/search/Search';\nimport SortBy from '@components/programs/sort-by/SortBy';\nimport { searchPrograms } from '@graphql/queries';\nimport { usePageBottom } from '../utils/hooks/usePageBottom';\nimport { useQuery } from '../utils/hooks/useQuery';\nimport useTranslation from 'next-translate/useTranslation';\nimport React, { useEffect, useState } from 'react';\n\nconst ProgramsPage = () => {\n  var _data$searchPrograms3, _data$searchPrograms4;\n\n  const {\n    t\n  } = useTranslation();\n  const {\n    0: variables,\n    1: setVariables\n  } = useState({\n    filter: {\n      published: {\n        eq: true\n      }\n    },\n    limit: 20\n  });\n  const {\n    data,\n    fetchMore,\n    isLoading\n  } = useQuery(searchPrograms, variables);\n  const isPageBottom = usePageBottom();\n  useEffect(() => {\n    var _data$searchPrograms;\n\n    if (!isLoading && isPageBottom && (_data$searchPrograms = data.searchPrograms) !== null && _data$searchPrograms !== void 0 && _data$searchPrograms.nextToken) {\n      var _data$searchPrograms2;\n\n      fetchMore((_data$searchPrograms2 = data.searchPrograms) === null || _data$searchPrograms2 === void 0 ? void 0 : _data$searchPrograms2.nextToken);\n    }\n  }, [isPageBottom]);\n\n  const handleSearch = query => {\n    if (!query) {\n      return setVariables({\n        filter: {\n          published: {\n            eq: true\n          }\n        },\n        limit: 20\n      });\n    }\n\n    setVariables({\n      filter: {\n        or: [{\n          name: {\n            matchPhrasePrefix: query\n          }\n        }, {\n          city: {\n            matchPhrasePrefix: query\n          }\n        }, {\n          country: {\n            matchPhrasePrefix: query\n          }\n        }, {\n          schoolName: {\n            matchPhrasePrefix: query\n          }\n        }],\n        published: {\n          eq: true\n        }\n      },\n      limit: 20\n    });\n  };\n\n  const handleFilter = filter => {\n    setVariables(prev => _objectSpread(_objectSpread({}, prev), {}, {\n      filter\n    }));\n  };\n\n  const handleSort = sort => {\n    setVariables(prev => _objectSpread(_objectSpread({}, prev), {}, {\n      sort\n    }));\n  };\n\n  const handleClick = () => {\n    console.log('Apply - to be implemented');\n  };\n\n  const headerComponents = [/*#__PURE__*/_jsxDEV(Search, {\n    handleSearch: handleSearch\n  }, 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(Filters, {\n    handleFilter: handleFilter\n  }, 1, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }, this), /*#__PURE__*/_jsxDEV(SortBy, {\n    handleSort: handleSort\n  }, 2, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 9\n  }, this)];\n  const skeletons = Array.from({\n    length: 12\n  }, (_v, k) => k + 1);\n  return /*#__PURE__*/_jsxDEV(DashboardLayout, {\n    description: t('programs:meta-description'),\n    title: t('programs:page-title'),\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      headerComponents: headerComponents,\n      innerPadding: false,\n      title: t('programs:programs'),\n      children: [(_data$searchPrograms3 = data.searchPrograms) === null || _data$searchPrograms3 === void 0 ? void 0 : (_data$searchPrograms4 = _data$searchPrograms3.items) === null || _data$searchPrograms4 === void 0 ? void 0 : _data$searchPrograms4.map(program => {\n        if (!program || !program.school) {\n          return;\n        }\n\n        const {\n          city,\n          country,\n          duration,\n          durationUnit,\n          fee,\n          feeCurrency,\n          feeUnit,\n          id,\n          intakes,\n          name,\n          schedule,\n          school,\n          slug\n        } = program;\n        return /*#__PURE__*/_jsxDEV(Row, {\n          city: city,\n          country: country,\n          duration: duration,\n          durationUnit: durationUnit,\n          fee: fee,\n          feeCurrency: feeCurrency,\n          feeUnit: feeUnit,\n          intakes: intakes,\n          name: name,\n          schedule: schedule,\n          school: {\n            logo: school.logo,\n            name: school.name\n          },\n          slug: slug,\n          onClick: handleClick\n        }, id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 25\n        }, this);\n      }), isLoading && skeletons.map((_skeleton, index) => /*#__PURE__*/_jsxDEV(SkeletonRow, {}, index, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 67\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 9\n  }, this);\n};\n\nexport default ProgramsPage;","map":{"version":3,"sources":["/home/paul/projects/applyfuture/students/packages/students/src/pages_/programs.tsx"],"names":["Container","DashboardLayout","Filters","Row","SkeletonRow","Search","SortBy","searchPrograms","usePageBottom","useQuery","useTranslation","React","useEffect","useState","ProgramsPage","t","variables","setVariables","filter","published","eq","limit","data","fetchMore","isLoading","isPageBottom","nextToken","handleSearch","query","or","name","matchPhrasePrefix","city","country","schoolName","handleFilter","prev","handleSort","sort","handleClick","console","log","headerComponents","skeletons","Array","from","length","_v","k","items","map","program","school","duration","durationUnit","fee","feeCurrency","feeUnit","id","intakes","schedule","slug","logo","_skeleton","index"],"mappings":"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","sourcesContent":["import Container from '@components/core/container/Container';\nimport DashboardLayout from '@components/layouts/dashboard-layout/DashboardLayout';\nimport Filters from '@components/programs/filters/Filters';\nimport Row from '@components/programs/row/Row';\nimport SkeletonRow from '@components/programs/row/SkeletonRow';\nimport Search from '@components/programs/search/Search';\nimport SortBy from '@components/programs/sort-by/SortBy';\nimport {\n    SearchableProgramFilterInput,\n    SearchableProgramSortInput,\n    SearchProgramsQuery,\n    SearchProgramsQueryVariables\n} from '@graphql/API';\nimport { searchPrograms } from '@graphql/queries';\nimport { usePageBottom } from '../utils/hooks/usePageBottom';\nimport { useQuery } from '../utils/hooks/useQuery';\nimport useTranslation from 'next-translate/useTranslation';\nimport React, { FC, useEffect, useState } from 'react';\n\nconst ProgramsPage: FC = () => {\n    const { t } = useTranslation();\n    const [variables, setVariables] = useState<SearchProgramsQueryVariables>({\n        filter: {\n            published: { eq: true }\n        },\n        limit: 20\n    });\n    const { data, fetchMore, isLoading } = useQuery<\n        SearchProgramsQuery,\n        SearchProgramsQueryVariables\n    >(searchPrograms, variables);\n    const isPageBottom = usePageBottom();\n\n    useEffect(() => {\n        if (!isLoading && isPageBottom && data.searchPrograms?.nextToken) {\n            fetchMore(data.searchPrograms?.nextToken);\n        }\n    }, [isPageBottom]);\n\n    const handleSearch = (query: string) => {\n        if (!query) {\n            return setVariables({\n                filter: {\n                    published: { eq: true }\n                },\n                limit: 20\n            });\n        }\n        setVariables({\n            filter: {\n                or: [\n                    { name: { matchPhrasePrefix: query } },\n                    { city: { matchPhrasePrefix: query } },\n                    { country: { matchPhrasePrefix: query } },\n                    { schoolName: { matchPhrasePrefix: query } }\n                ],\n                published: { eq: true }\n            },\n            limit: 20\n        });\n    };\n\n    const handleFilter = (filter: SearchableProgramFilterInput) => {\n        setVariables((prev: SearchProgramsQueryVariables) => ({\n            ...prev,\n            filter\n        }));\n    };\n\n    const handleSort = (sort: SearchableProgramSortInput) => {\n        setVariables((prev: SearchProgramsQueryVariables) => ({\n            ...prev,\n            sort\n        }));\n    };\n\n    const handleClick = () => {\n        console.log('Apply - to be implemented');\n    };\n\n    const headerComponents = [\n        <Search key={0} handleSearch={handleSearch} />,\n        <Filters key={1} handleFilter={handleFilter} />,\n        <SortBy key={2} handleSort={handleSort} />\n    ];\n\n    const skeletons = Array.from({ length: 12 }, (_v, k) => k + 1);\n\n    return (\n        <DashboardLayout\n            description={t('programs:meta-description')}\n            title={t('programs:page-title')}>\n            <Container\n                headerComponents={headerComponents}\n                innerPadding={false}\n                title={t('programs:programs')}>\n                {data.searchPrograms?.items?.map((program) => {\n                    if (!program || !program.school) {\n                        return;\n                    }\n\n                    const {\n                        city,\n                        country,\n                        duration,\n                        durationUnit,\n                        fee,\n                        feeCurrency,\n                        feeUnit,\n                        id,\n                        intakes,\n                        name,\n                        schedule,\n                        school,\n                        slug\n                    } = program;\n\n                    return (\n                        <Row\n                            key={id}\n                            city={city}\n                            country={country}\n                            duration={duration}\n                            durationUnit={durationUnit}\n                            fee={fee}\n                            feeCurrency={feeCurrency}\n                            feeUnit={feeUnit}\n                            intakes={intakes}\n                            name={name}\n                            schedule={schedule}\n                            school={{ logo: school.logo, name: school.name }}\n                            slug={slug}\n                            onClick={handleClick}\n                        />\n                    );\n                })}\n                {isLoading && skeletons.map((_skeleton, index) => <SkeletonRow key={index} />)}\n            </Container>\n        </DashboardLayout>\n    );\n};\n\nexport default ProgramsPage;\n"]},"metadata":{},"sourceType":"module"}