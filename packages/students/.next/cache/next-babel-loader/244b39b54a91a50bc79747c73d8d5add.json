{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/home/paul/projects/applyfuture/students/node_modules/@applyfuture/utils/src/hooks/useAuthenticatedUser.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport Amplify, { Auth } from 'aws-amplify';\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport config from './../services/aws-exports';\nvar AuthenticatedUserContext = /*#__PURE__*/createContext(null);\nexport var AuthenticatedUserProvider = function AuthenticatedUserProvider(props) {\n  _s();\n\n  var children = props.children;\n\n  var _useState = useState(null),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  useEffect(function () {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _user;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return Auth.currentAuthenticatedUser();\n\n              case 3:\n                _user = _context.sent;\n                setUser(_user);\n                _context.t0 = console;\n                _context.next = 8;\n                return Auth.currentSession();\n\n              case 8:\n                _context.t1 = _context.sent;\n\n                _context.t0.log.call(_context.t0, 'current session:', _context.t1);\n\n                console.log({\n                  user: _user\n                });\n                _context.next = 22;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t2 = _context[\"catch\"](0);\n                Amplify.configure(_objectSpread(_objectSpread({}, config), {}, {\n                  aws_appsync_authenticationType: 'API_KEY'\n                }));\n                _context.t3 = console;\n                _context.next = 19;\n                return Auth.currentSession();\n\n              case 19:\n                _context.t4 = _context.sent;\n\n                _context.t3.log.call(_context.t3, 'current session:', _context.t4);\n\n                console.log('auth provider', {\n                  error: _context.t2\n                });\n\n              case 22:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 13]]);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthenticatedUserContext.Provider, {\n    value: user,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(AuthenticatedUserProvider, \"5s2qRsV95gTJBmaaTh11GoxYeGE=\");\n\n_c = AuthenticatedUserProvider;\nexport var useAuthenticatedUser = function useAuthenticatedUser() {\n  _s2();\n\n  return useContext(AuthenticatedUserContext);\n};\n\n_s2(useAuthenticatedUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthenticatedUserProvider\");","map":{"version":3,"sources":["/home/paul/projects/applyfuture/students/node_modules/@applyfuture/utils/src/hooks/useAuthenticatedUser.tsx"],"names":["Amplify","Auth","createContext","useContext","useEffect","useState","config","AuthenticatedUserContext","AuthenticatedUserProvider","props","children","user","setUser","fetchData","currentAuthenticatedUser","console","currentSession","log","configure","aws_appsync_authenticationType","error","useAuthenticatedUser"],"mappings":";;;;;;;;;;;;;;AAAA,OAAOA,OAAP,IAAkBC,IAAlB,QAA8B,aAA9B;AACA,SAASC,aAAT,EAAuCC,UAAvC,EAAmDC,SAAnD,EAA8DC,QAA9D,QAA8E,OAA9E;AAEA,OAAOC,MAAP,MAAmB,2BAAnB;AAYA,IAAMC,wBAAwB,gBAAGL,aAAa,CAA2B,IAA3B,CAA9C;AAEA,OAAO,IAAMM,yBAAoC,GAAG,SAAvCA,yBAAuC,CAACC,KAAD,EAAW;AAAA;;AAAA,MACnDC,QADmD,GACtCD,KADsC,CACnDC,QADmD;;AAAA,kBAEnCL,QAAQ,CAAC,IAAD,CAF2B;AAAA,MAEpDM,IAFoD;AAAA,MAE9CC,OAF8C;;AAI3DR,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAMS,SAAS;AAAA,0EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAESZ,IAAI,CAACa,wBAAL,EAFT;;AAAA;AAEJH,gBAAAA,KAFI;AAGVC,gBAAAA,OAAO,CAACD,KAAD,CAAP;AAHU,8BAIVI,OAJU;AAAA;AAAA,uBAI4Bd,IAAI,CAACe,cAAL,EAJ5B;;AAAA;AAAA;;AAAA,4BAIFC,GAJE,mBAIE,kBAJF;;AAMVF,gBAAAA,OAAO,CAACE,GAAR,CAAY;AAAEN,kBAAAA,IAAI,EAAJA;AAAF,iBAAZ;AANU;AAAA;;AAAA;AAAA;AAAA;AAQVX,gBAAAA,OAAO,CAACkB,SAAR,iCACOZ,MADP;AAEIa,kBAAAA,8BAA8B,EAAE;AAFpC;AARU,8BAYVJ,OAZU;AAAA;AAAA,uBAY4Bd,IAAI,CAACe,cAAL,EAZ5B;;AAAA;AAAA;;AAAA,4BAYFC,GAZE,mBAYE,kBAZF;;AAaVF,gBAAAA,OAAO,CAACE,GAAR,CAAY,eAAZ,EAA6B;AAAEG,kBAAAA,KAAK;AAAP,iBAA7B;;AAbU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAATP,SAAS;AAAA;AAAA;AAAA,OAAf;;AAgBAA,IAAAA,SAAS;AACZ,GAlBQ,EAkBN,EAlBM,CAAT;AAoBA,sBACI,QAAC,wBAAD,CAA0B,QAA1B;AAAmC,IAAA,KAAK,EAAEF,IAA1C;AAAA,cACKD;AADL;AAAA;AAAA;AAAA;AAAA,WADJ;AAKH,CA7BM;;GAAMF,yB;;KAAAA,yB;AA+Bb,OAAO,IAAMa,oBAAoB,GAAG,SAAvBA,oBAAuB;AAAA;;AAAA,SAChClB,UAAU,CAACI,wBAAD,CADsB;AAAA,CAA7B;;IAAMc,oB","sourcesContent":["import Amplify, { Auth } from 'aws-amplify';\nimport { createContext, FC, ReactNode, useContext, useEffect, useState } from 'react';\n\nimport config from './../services/aws-exports';\n\ntype AuthenticatedUser = {\n    attributes: {\n        email: string;\n    };\n};\n\ntype Props = {\n    children: ReactNode;\n};\n\nconst AuthenticatedUserContext = createContext<AuthenticatedUser | null>(null);\n\nexport const AuthenticatedUserProvider: FC<Props> = (props) => {\n    const { children } = props;\n    const [user, setUser] = useState(null);\n\n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n                const user = await Auth.currentAuthenticatedUser();\n                setUser(user);\n                console.log('current session:', await Auth.currentSession());\n\n                console.log({ user });\n            } catch (error) {\n                Amplify.configure({\n                    ...config,\n                    aws_appsync_authenticationType: 'API_KEY'\n                });\n                console.log('current session:', await Auth.currentSession());\n                console.log('auth provider', { error });\n            }\n        };\n        fetchData();\n    }, []);\n\n    return (\n        <AuthenticatedUserContext.Provider value={user}>\n            {children}\n        </AuthenticatedUserContext.Provider>\n    );\n};\n\nexport const useAuthenticatedUser = (): AuthenticatedUser | null =>\n    useContext(AuthenticatedUserContext);\n"]},"metadata":{},"sourceType":"module"}